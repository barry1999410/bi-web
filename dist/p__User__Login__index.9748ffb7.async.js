"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{91792:function(de,P,a){a.r(P),a.d(P,{default:function(){return te}});var z=a(15009),d=a.n(z),V=a(97857),F=a.n(V),$=a(99289),v=a.n($),E=a(5574),j=a.n(E),W=a(47556),D=a(71356),b=a(38123),G=a(87547),Z=a(94149),H=a(24454),Q=a(47207),y=a(28711),K=a(16434),t=a(80854),Y=a(38925),m=a(2453),J=a(68879),X=a(67610),M=a(67294),k=a(73935),q=a(52720),T=a(21819);function _(f,r){return S.apply(this,arguments)}function S(){return S=v()(d()().mark(function f(r,c){return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,t.request)("/api/sms/code",F()({method:"POST",headers:{"Content-Type":"application/json"},data:r},c||{})));case 1:case"end":return p.stop()}},f)})),S.apply(this,arguments)}var e=a(85893),A=(0,q.kc)(function(f){var r=f.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:r.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:r.borderRadius,":hover":{backgroundColor:r.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),ee=function(){var r=A(),c=r.styles,x="http://localhost:8000/welcome",p="wx4c553ebbc9cd3563",C=function(){window.location.href="https://open.weixin.qq.com/connect/qrconnect?appid=".concat(p,"&redirect_uri=").concat(x,"&response_type=code&scope=SCOPE&state=STATE#wechat_redirect")};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{className:c.action,onClick:C},"WechatOutlined"),(0,e.jsx)(b.Z,{className:c.action},"QqOutlined")]})},ae=function(){var r=A(),c=r.styles;return(0,e.jsx)("div",{className:c.lang,"data-lang":!0,children:t.SelectLang&&(0,e.jsx)(t.SelectLang,{})})},I=function(r){var c=r.content;return(0,e.jsx)(Y.Z,{style:{marginBottom:24},message:c,type:"error",showIcon:!0})},se=function(){var r=(0,M.useState)({}),c=j()(r,2),x=c[0],p=c[1],C=(0,M.useState)("account"),B=j()(C,2),L=B[0],re=B[1],U=(0,t.useModel)("@@initialState"),ge=U.initialState,ne=U.setInitialState,ue=A(),oe=ue.styles,i=(0,t.useIntl)(),ie=(0,M.useState)(""),O=j()(ie,2),fe=O[0],he=O[1];(0,M.useEffect)(function(){});var le=function(){var g=v()(d()().mark(function s(){var o;return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.as)();case 2:o=n.sent,o&&(0,k.flushSync)(function(){ne(function(l){return F()(F()({},l),{},{currentUser:o})})});case 4:case"end":return n.stop()}},s)}));return function(){return g.apply(this,arguments)}}(),ce=function(){var g=v()(d()().mark(function s(o){var h,n,l,N;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,T.Yl)(o);case 3:if(h=u.sent,h.code!==0){u.next=14;break}return n=i.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),m.ZP.success(n),u.next=9,le();case 9:return l=new URL(window.location.href).searchParams,t.history.push(l.get("redirect")||"/"),u.abrupt("return");case 14:m.ZP.error(h.message);case 15:u.next=22;break;case 17:u.prev=17,u.t0=u.catch(0),N=i.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(u.t0),m.ZP.error(N);case 22:case"end":return u.stop()}},s,null,[[0,17]])}));return function(o){return g.apply(this,arguments)}}(),R=x.status,w=x.type;return(0,e.jsxs)("div",{className:oe.container,children:[(0,e.jsx)(t.Helmet,{children:(0,e.jsxs)("title",{children:[i.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",X.Z.title]})}),(0,e.jsx)(ae,{}),(0,e.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,e.jsxs)(Q.U,{onValuesChange:function(s){return console.log("values",s)},contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:"/bi.svg"}),title:"Auto BI",subTitle:null,initialValues:{autoLogin:!0},actions:[(0,e.jsx)(t.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,e.jsx)(ee,{},"icons")],onFinish:function(){var g=v()(d()().mark(function s(o){return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ce(o);case 2:case"end":return n.stop()}},s)}));return function(s){return g.apply(this,arguments)}}(),children:[(0,e.jsx)(J.Z,{activeKey:L,onChange:re,centered:!0,items:[{key:"account",label:i.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"phone",label:i.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),R==="error"&&w==="account"&&(0,e.jsx)(I,{content:i.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),L==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{name:"userAccount",fieldProps:{size:"large",prefix:(0,e.jsx)(G.Z,{})},placeholder:i.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(y.Z.Password,{name:"userPassword",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},placeholder:i.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),R==="error"&&w==="phone"&&(0,e.jsx)(I,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),L==="phone"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(H.Z,{})},name:"phone",placeholder:i.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(K.Z,{phoneName:"phone",fieldProps:{size:"large",prefix:(0,e.jsx)(Z.Z,{})},captchaProps:{size:"large"},placeholder:i.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(s,o){return s?"".concat(o," ").concat(i.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):i.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var g=v()(d()().mark(function s(o){var h;return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return m.ZP.success("\u624B\u673A\u53F7 ".concat(o," \u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F!")),l.next=3,_({phone:o});case 3:if(h=l.sent,h.code!==5e4){l.next=7;break}return m.ZP.error("\u9A8C\u8BC1\u7801\u670D\u52A1\u51FA\u9519"),l.abrupt("return");case 7:m.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01");case 8:case"end":return l.stop()}},s)}));return function(s){return g.apply(this,arguments)}}()})]}),(0,e.jsx)("div",{style:{marginBottom:24},children:(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})})]})}),(0,e.jsx)(W.$_,{})]})},te=se}}]);
